---
layout: post
title: "rust serialize and json"
date: 2025-05-03 02:22:00 +0800
categories: rust 

---



# Rust ä¸­çš„ `Serialize` ä¸ Shell ä¸­çš„ `jq` åŒºåˆ«

æœ¬æ–‡å¯¹æ¯” Rust ä¸­çš„ `serde::Serialize` å’Œ Shell å‘½ä»¤è¡Œå·¥å…· `jq`ï¼Œä¸¤è€…è™½ç„¶éƒ½æ¶‰åŠ JSONï¼Œä½†ç”¨é€”å’Œç”¨æ³•å®Œå…¨ä¸åŒã€‚

---

## âœ… æ ¸å¿ƒåŒºåˆ«ä¸€è§ˆ

| é¡¹ç›®             | Rust `Serialize`                            | Shell `jq`                                   |
|------------------|---------------------------------------------|-----------------------------------------------|
| å·¥å…·ç±»åˆ«         | ç¼–ç¨‹è¯­è¨€ç‰¹æ€§ï¼ˆé€šè¿‡ serde æ´¾ç”Ÿï¼‰             | å‘½ä»¤è¡Œ JSON è§£æå™¨å·¥å…·                       |
| ä½¿ç”¨è¯­è¨€         | Rust                                        | Shellï¼ˆbash/zsh ç­‰ï¼‰                          |
| ä¸»è¦ç”¨é€”         | å°†ç»“æ„ä½“ã€æšä¸¾ç­‰è½¬æ¢ä¸º JSONã€YAML ç­‰æ ¼å¼    | ä» JSON æ•°æ®ä¸­æå–ã€è¿‡æ»¤ã€ä¿®æ”¹               |
| ä½¿ç”¨æ–¹å¼         | åœ¨ä»£ç ä¸­è°ƒç”¨ `serde_json::to_string` ç­‰æ–¹æ³• | é€šè¿‡ `jq` å‘½ä»¤åœ¨ç»ˆç«¯è§£æ JSON å­—ç¬¦ä¸²         |
| è½¬æ¢æ–¹å‘         | Rust å¯¹è±¡ â†’ JSONï¼ˆåºåˆ—åŒ–ï¼‰                 | JSON å­—ç¬¦ä¸² â†’ å­—æ®µå€¼ï¼ˆè§£æï¼‰                 |
| ä¾èµ–/å·¥å…·        | `serde`, `serde_json` ç­‰åº“                  | å®‰è£… `jq` å‘½ä»¤è¡Œå·¥å…·                          |

---

## ğŸ”§ ç¤ºä¾‹å¯¹æ¯”

### âœ… Rust ä¸­åºåˆ—åŒ–ï¼ˆ`serde::Serialize`ï¼‰

```rust
use serde::Serialize;

#[derive(Serialize)]
struct User {
    name: String,
    age: u32,
}

fn main() {
    let u = User {
        name: "Alice".to_string(),
        age: 30,
    };

    let json = serde_json::to_string(&u).unwrap();
    println!("{}", json); // è¾“å‡ºï¼š{"name":"Alice","age":30}
}
```

---

### âœ… Shell ä¸­è§£æ JSONï¼ˆ`jq`ï¼‰

```bash
cat data.json | jq '.name'
# å‡è®¾ data.json å†…å®¹æ˜¯ï¼š{"name":"Alice","age":30}
# è¾“å‡º: "Alice"
```

---

## ğŸ§  æ€»ç»“ç±»æ¯”

| åŠŸèƒ½              | Rust                              | Shell (`jq`)          |
|-------------------|-----------------------------------|------------------------|
| æ„å»ºæ•°æ®ç»“æ„       | `struct` + `#[derive(Serialize)]` | ä¸é€‚ç”¨                 |
| è½¬æ¢ä¸º JSON        | `serde_json::to_string(...)`      | ä¸æ”¯æŒ                 |
| è¯»å–/è§£æ JSON     | `serde_json::from_str(...)`       | `jq '.field'`          |
| é€‚ç”¨åœºæ™¯           | å†™ç¨‹åºã€æœåŠ¡ç«¯æ•°æ®å¤„ç†            | å‘½ä»¤è¡Œè°ƒè¯•ã€è½»é‡è„šæœ¬   |

---

## âœ… æ€»ç»“

- **Rust çš„ `Serialize`** ç”¨äºå°†ç»“æ„ä½“åºåˆ—åŒ–ä¸º JSON å­—ç¬¦ä¸²ï¼Œé€‚åˆç¨‹åºå†…éƒ¨ä½¿ç”¨ï¼›
- **Shell çš„ `jq`** ç”¨äºå‘½ä»¤è¡Œä¸­è¯»å–å’Œæ“ä½œ JSON æ–‡æœ¬ï¼Œéå¸¸é€‚åˆæ•°æ®æå–ä¸è¿‡æ»¤ï¼›
- äºŒè€…ç”¨é€”ä¸åŒï¼Œä½†åœ¨ JSON æ•°æ®å¤„ç†é“¾æ¡ä¸­å¯ä»¥äº’è¡¥ä½¿ç”¨ã€‚
